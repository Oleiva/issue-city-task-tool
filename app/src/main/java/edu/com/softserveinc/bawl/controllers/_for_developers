Refactoring : move business logic out of controllers to service layer